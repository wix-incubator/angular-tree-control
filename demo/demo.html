<!doctype html>
<html>
<head>
    <script src="../bower_components/jquery/jquery.js"></script>
    <script src="../bower_components/angular/angular.js"></script>
    <script src="../bower_components/bootstrap/dist/js/bootstrap.js"></script>
    <script src="../bower_components/angular-bootstrap/ui-bootstrap-tpls.js"></script>
    <script src="../bower_components/google-code-prettify/src/prettify.js"></script>

    <link  href="../bower_components/bootstrap/dist/css/bootstrap.css" rel="stylesheet" type="text/css">
    <link  href="prettify-style.css" rel="stylesheet" type="text/css">

    <script src="../angular-tree-control.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/tree-control.css">
    <link rel="stylesheet" type="text/css" href="../css/tree-control-attribute.css">
    <style>
        h2, h3 {font-family: Georgia; font-style: italic}
        .example-caption {color: #bbb; font-size: 12px}
        .fake-link {color: blue; text-decoration: underline; cursor: pointer;}
        .docs-body{width: 1140px; margin: auto;}
        .tab-pane{background-color: #f8f8f8; border-right: 1px solid #ccc;border-left: 1px solid #ccc;border-bottom: 1px solid #ccc; border-bottom-left-radius: 3px; border-bottom-right-radius: 3px }
        .nav li.active a{background-color: #f8f8f8}
        pre.code {border:none; background-color: #f8f8f8; padding: 10px; margin: 0; font-family: Consolas, 'Liberation Mono', Courier, monospace;}
    </style>
</head>
<body ng-app="example">

<div class="docs-body">

    <section id="classic" ng-controller="Classic">
        <div class="page-header">
            <h1>Classic Style <small>(Basic style, default configuration)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="classic-html">
                            <treecontrol class="tree-classic"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)">
                                label: {{node.label}} ({{node.id}})
                            </treecontrol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>Classic style of the tree control, set using the class <code>tree-classic</code>.</p>
                <p>Click on the folder icons to open and close the tree nodes. Click on the node label to select a node in the tree.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="classic-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="classic-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="classic-js">
            function Classic($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>

    <section id="as-attribute" ng-controller="AsAttribute">
        <div class="page-header">
            <h1>Using as Attribute <small>(Instead of a Custom Element)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="as-attribute-html">
                            <div treecontrol class="tree-classic"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)">
                                label: {{node.label}} ({{node.id}})
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>Using the tree control as an attribute is as easy as using a div and adding a <code>treecontrol</code> attribute to it</p>
                <p>Note that you have to include the <code>tree-control-attribute.css</code> file instead of the <code>tree-control.css</code>
                    as the CSS selectors are quite different between the two styles of using the tree control.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="as-attribute-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="as-attribute-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="as-attribute-js">
            function AsAttribute($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>

    <section id="light" ng-controller="Light">
        <div class="page-header">
            <h1>Light Style <small>(Basic style, default configuration)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="light-html">
                            <treecontrol class="tree-light"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)">
                                label: {{node.label}} ({{node.id}})
                            </treecontrol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>Light style of the tree control, set using the class <code>tree-light</code>.</p>
                <p>Click on the folder icons to open and close the tree nodes. Click on the node label to select a node in the tree.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="light-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="light-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="light-js">
            function Light($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>

    <section id="dark" ng-controller="Dark">
        <div class="page-header">
            <h1>Dark Style <small>(Basic style, default configuration)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body" style="background-color: #555;">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="dark-html">
                            <!-- Note that the tree does not set the background color. We inject it from the wrapper div. -->
                            <div style="background-color: #555;">
                                <treecontrol class="tree-dark"
                                             tree-model="treedata"
                                             options="opts"
                                             on-selection="showSelected(node)">
                                    label: {{node.label}} ({{node.id}})
                                </treecontrol>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>Dark style of the tree control, set using the class <code>tree-dark</code>. The style does not include the background color, instead,
                inject your own background color using a wrapper div element.</p>
                <p>Click on the folder icons to open and close the tree nodes. Click on the node label to select a node in the tree.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="dark-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="dark-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="dark-js">
            function Dark($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>

    <section id="labels-template" ng-controller="LabelsTemplate">
        <div class="page-header">
            <h1>Tree Label Templates <small>(Customize the tree labels)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="labels-template-html">
                            <treecontrol class="tree-classic"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)">
                                <span style="color: {{getColor(node)}}">{{node.label}}</span>
                            </treecontrol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>Taking control of the tree labels is as simple as with <code>ng-repeat</code> - you include a template in the tree control tag.</p>
                <p>The current node is ingected into that template as the <code>node</code> scope parameter.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="labels-template-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="labels-template-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="labels-template-js">
            function LabelsTemplate($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

                $scope.getColor = function(node) {
                    return ["#a40", "#04a", "#990", "#0a4"][node.i % 4];
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>


    <section id="dirSelection" ng-controller="DirSelection">
        <div class="page-header">
            <h1>Clicking Labels Expand & Collapse <small>(options.dirSelectable)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="dir-selection-html">
                            <treecontrol class="tree-classic"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)">
                                label: {{node.label}} ({{node.id}})
                            </treecontrol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>In order to prevent selection of branches (folders) in the tree, set the <code>options.dirSelectable</code> to <code>false</code>.
                    Clicking folder labels at this point will expand and contract the node.</p>
                <p>Selected node: <code>{{selectedNode?selectedNode.label:"N/A"}}</code></p>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="dir-selection-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="dir-selection-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="dir-selection-js">
            function DirSelection($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: false
                };

                $scope.showSelected = function(sel) {
                    $scope.selectedNode = sel;
                };
            }
        </script>
    </section>


    <section id="events" ng-controller="Events">
        <div class="page-header">
            <h1>Events <small>(onExpand & onSelection)</small></h1>
        </div>
        <div class="row">
            <div class="col-md-6 show-grid">
                <div class="panel panel-default">
                    <div class="panel-body">
                        <div class="example-caption">EXAMPLE:</div>
                        <div save-content="events-html">
                            <treecontrol class="tree-classic"
                                         tree-model="treedata"
                                         options="opts"
                                         on-selection="showSelected(node)"
                                         on-node-toggle="showToggle(node, expanded)">
                                label: {{node.label}} ({{node.id}})
                            </treecontrol>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <p>In order to prevent selection of branches (folders) in the tree, set the <code>options.dirSelectable</code> to <code>false</code>.
                    Clicking folder labels at this point will expand and contract the node.</p>
                <p>Events fired:</p>
                <ul id="events-listing">

                </ul>
            </div>
        </div>
        <div class="row">
            <tabset>
                <tab heading="Markup" >
                    <pre class="code" apply-content="events-html" highlight-lang="html"></pre>
                </tab>
                <tab heading="JavaScript">
                    <pre class="code" apply-content="events-js" highlight-lang="js"></pre>
                </tab>
            </tabset>
        </div>
        <script save-content="events-js">
            function Events($scope) {
                $scope.treedata=createSubTree(3, 4, "");
                $scope.showToggle = function(node, expanded) {
                    $("#events-listing").append("<li>"+node.label+ (expanded?" expanded":" collapsed") + "</li>");
                };

                $scope.showSelected = function(node) {
                    $("#events-listing").append("<li>"+node.label+" selected</li>");
                };

                $scope.opts = {
                    nodeChildren: "children",
                    dirSelectable: true
                };

            }
        </script>
    </section>



    events - selection and expand
    start tree with expanded nodes
    set selected - selected node
    set expanded - expanded nodes
    customizing css classes
    conditional css class
    order nodes
</div>


<script>
    var entityMap = {
        "&": "&amp;",
        "<": "&lt;",
        ">": "&gt;",
        '"': '&quot;',
        "'": '&#39;',
        "/": '&#x2F;'
    };

    function escapeHtml(string) {
        return String(string).replace(/[&<>"'\/]/g, function (s) {
            return entityMap[s];
        });
    }

    var nonSpace = /\S/;
    function trimIndent(content) {
        var lines = content.split("\n");
        var begin = 0;
        var end = lines.length-1;
        while ((nonSpace.exec(lines[begin]) == null) && (begin < lines.length))
            begin = begin + 1;
        while ((nonSpace.exec(lines[end]) == null) && end >= begin)
            end = end - 1;
        var ident = nonSpace.exec(lines[begin]).index;
        var formatted = "";
        for (var i = begin; i <= end; i++) {
            formatted = formatted + lines[i].slice(ident-1) + ((i < end)?"\n":"");
        }
        return formatted;

    }
    var example = angular.module("example", ["treeControl", "ui.bootstrap", "template/tabs/tab.html", "template/tabs/tabset.html"])
                    .factory("$savedContent", function() {
                        return [];
                    })
                    .directive("saveContent", function($savedContent) {
                        return {
                            restrict: "A",
                            compile: function($element, $attrs) {
                                var content = $element.html();
                                $savedContent[$attrs.saveContent] = content;
                            }
                        }
                    })
                    .directive("applyContent", function($savedContent) {
                        return {
                            restrict: "EAC",
                            compile: function($element, $attrs) {
                                return function($scope, $element, $attrs) {
                                    var content = $savedContent[$attrs.applyContent];
                                    var lang = $attrs.highlightLang;
                                    if (lang == "html")
                                        content = escapeHtml(content);
                                    content = trimIndent(content);
                                    var pre = prettyPrintOne(content, lang);
                                    $element.html(pre);
                                }
                            }
                        }
                    })
            ;

    function createSubTree(level, width, prefix) {
        if (level > 0) {
            var res = [];
            for (var i=1; i <= width; i++)
                res.push({ "label" : "Node " + prefix + i, "id" : "id"+prefix + i, "i": i, "children": createSubTree(level-1, width, prefix + i +".") });
            return res;
        }
        else
            return [];
    }

</script>

</body>
</html>